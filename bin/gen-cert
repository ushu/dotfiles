#/usr/bin/env sh

echo "--------------------------------------------------------------------------------"
echo " Generate a private key in $1.key: choose a passphrase"
echo "--------------------------------------------------------------------------------"
openssl genrsa -des3 -out $1.key 2048

echo "--------------------------------------------------------------------------------"
echo " Generate a key phrase WITHOUT the passphrase" 
echo " (this has to be done in 2 steps...)" 
echo "--------------------------------------------------------------------------------"
mv $1.key $1-passphrase.key
openssl rsa -in $1-passphrase.key -out $1.key

echo "--------------------------------------------------------------------------------"
echo " Generate a Certificate Signing Request in $1.crt using $1.key"
echo "--------------------------------------------------------------------------------"
openssl req -new -key $1.key -out $1.csr


echo "--------------------------------------------------------------------------------"
echo " Generate a Self-Signed Certificate"
echo " THE HOSTNAME FOISE INTO the \"Common Name\" section"
echo "--------------------------------------------------------------------------------"
openssl x509 -req -days 3650 -in $1.csr -signkey $1.key -out $1.crt

echo "--------------------------------------------------------------------------------"
echo " Generate a DER version of the Certificate"
echo "--------------------------------------------------------------------------------"
openssl x509 -inform PEM -in $1.crt -outform DER -out $1.der



